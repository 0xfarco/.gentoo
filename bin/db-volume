#!/bin/bash

# Prints the current volume or ðŸ”‡ if muted.

case $BLOCK_BUTTON in
	1) setsid -w -f "$TERMINAL" -e pulsemixer; pkill -RTMIN+10 "${STATUSBAR:-dwmblocks}" ;;
	2) pulsemixer --id sink-0 --toggle-mute ;;
	4) pulsemixer --change-volume +1 ;;
	5) pulsemixer --change-volume -1 ;;
	3) notify-send "ðŸ“¢ Volume module" "\- Shows volume ðŸ”Š, ðŸ”‡ if muted.
- Middle click to mute.
- Scroll to change." ;;
	6) setsid -f "$TERMINAL" -e "$EDITOR" "$0" ;;
esac

# Check if muted
if [ "$(pulsemixer --get-mute)" -eq 1 ]; then
    echo ðŸ”‡
    exit
fi

# Get volume (first field from output)
vol="$(pulsemixer --get-volume | awk '{print $1}')"

# Truncate decimal if any (no external tools)
vol="${vol%%.*}"

case 1 in
	$((vol >= 70)) ) icon="ðŸ”Š" ;;
	$((vol >= 30)) ) icon="ðŸ”‰" ;;
	$((vol >= 1)) ) icon="ðŸ”ˆ" ;;
	* ) echo ðŸ”‡ && exit ;;
esac

echo "$icon $vol%"
